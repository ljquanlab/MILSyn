# Multiscale Drug-Cell Interaction Modeling via Hybrid Graph Architectures and Knowledge-Aware Fusion for Drug Synergy Prediction

## Abstract

Accurate prediction of drug combination synergy remains challenging due to the vast combinatorial space and strong cellular context-dependency of drug responses. To address these limitations, we present MILSyn, a multimodal interaction learning framework designed to capture multi-scale drug-cell interactions through three integrated components: (1) relational modeling of heterogeneous graph structures using a hybrid RGCN-GATv2 architecture, (2) cross-modal fusion of biochemical features spanning SMILES, substructures, 3D conformations, and multi-omics profiles, and (3) knowledge-aware reasoning via LLM-derived semantic embeddings. Evaluated on DrugComb and four external benchmarks, MILSyn consistently outperforms state-of-the-art models, demonstrating robust generalization in cold-start scenarios and significant performance gains under few-shot fine-tuning for rare tumors. Attention-based analyses further reveal biologically meaningful molecular and pathway determinants of synergy. By combining scalability with interpretability, MILSyn offers a mechanism-aware framework to accelerate rational drug combination design in precision oncology.

### Model overview

![image-20251202133147466](C:\Users\Maoyexuan\AppData\Roaming\Typora\typora-user-images\image-20251202133147466.png)

### Project structure

- `data/` contains data files and data processing files;
- `dataset/` contains the necessary files for creating the dataset;
- `json/` contains drug and cell line characterization data generated by LLM;
- `models/` contains different modules of MILSyn;
- `saved_model/` contains the trained weights of MILSyn;
- `experiment/` contains log files and output files;
- `utils.py` contains the necessary processing subroutines;
- `metrics.py` contains the necessary functions to calculate model evaluation metrics;
- `main.py` main function for MILSyn.

## Implementation

#### Data Preprocessing

- In MILSyn, we use normalized multi-omics data of cell lines and substructure encodings of drugs as input features. The preprocessed data is stored in `data/0_cell_data/` and `data/1_drug_data/`. You can also preprocess your own data by following the steps in `data/data_process.ipynb`.

â€‹	(Multi-omics data can be downloaded from the [GSanShui/SynergyX](https://github.com/GSanShui/SynergyX))

- Our collected drug combination data is stored in `data/split/all_items.npy`, where the data items are in the format `[drugA_canonical_smi, drugB_canonical_smi, cell_ID, label]`. Note that your data should be organized in the same format. If the label is unknown, assign a value of `0.` to the label.
- Before training or testing the model, remember to update the data path within `utils.py`.

### Model Training

```
python main.py --mode train --batch_szie 256 --nfold 21 > './experiment/'$(date +'%Y%m%d_%H%M').log
```